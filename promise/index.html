<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<script>
    var tasks = [];
    var output = function(j){
       return  new Promise(function(resolve){
            setTimeout(function(){
                console.log(new Date(), j);
                resolve();
            }, 1000 * j);
        })
    };
    for(var i = 0; i < 5; i++){
        tasks.push(output(i));
    }
    Promise.all(tasks).then(function(){
        setTimeout(function(){
            console.log(new Date, i);
        }, 1000)
    })

    // for(var i = 0; i < 5; i++){
    //     (function(j){
    //         setTimeout(function(){
    //             console.log(new Date, j);
    //         }, 1000 * j);
    //     })(i);
    //
    // }
    // setTimeout(function(){
    //     console.log(new Date, i);
    // }, 1000 * i);

</script>
</body>
</html>